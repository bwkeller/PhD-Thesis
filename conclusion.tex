In this thesis we have explored the effects of SN feedback in the formation of 
galaxies like our own.  We introduced a novel model for SN feedback that
takes into account the important effects of previously ignored physics: the
evaporation of cold gas driven by thermal conduction.  This model allowed us to
see when SN can (and cannot!) regulate the flow of gas into and out of galaxies,
where it may forms stars.  We have also shown that the current $\Lambda
CDM$ cosmological model is consistent with recent observations of galaxy
kinematics.

In Chapter 2, we presented a detailed description of the new superbubble model,
implemented in the SPH code {\sc Gasoline2}.  We rely on the strongly
self-limiting process of thermal evaporation \citep{Cowie1977}, where cold mass
is evaporated into a hot bubble at a rate strongly dependent on the temperature
of the hot bubble. This drives the interior of the bubble to a temperature of a
few $10^6$ K, evaporating material more or less rapidly as the temperature dips
above or below this value.  This is the characteristic temperature for SN-heated
gas.  We use this physics to develop a new model for SN feedback, that gives
realistic estimates for cooling in unresolved hot bubbles, and accurately
calculates the mass loading of SN energy.  We demonstrated that this model is
insensitive to resolution, unresolved ISM structure, and uncertain (turbulent)
magnetic fields.  The strong temperature dependence of thermal evaporation means
that significant changes to the conduction rate (such as the supression by
magnetic fields) result in only slight changes to the temperature of
feedback-heated gas.  Finally, after investigating the behaviour of individual
bubbles, we showed that superbubble feedback is more effective at both
regulating star formation and at driving galactic winds.

Isolated disc simulations, like that shown in chapter 2, lack a full
cosmological history.  To see how SN feedback can impact the overall growth and
history of a galaxy like the Milky Way, we needed to simulate the galaxy from
high redshift to the present.  In chapter 3, we use zoom-in cosmological
simulations \citet{Navarro1993} of a Milky Way-like galaxy to compare the
effects of different feedback models.  The galaxy, when simulated using our new
superbubble model, was able to produce a realistic stellar mass fraction for the
galaxy's entire history.  Not only did the galaxy simulated with superbubble
feedback have the correct stellar mass, we showed that it also was effectively
bulgeless, with a completely flat rotation curve.  These two properties arose
via a single process.  At high redshift, superbubble feedback efficiently drives
heavily mass loaded winds, expelling gas from the ISM of the galaxy.  The gas
that forms a stellar bulge is accreted at high redshift, meaning that these
winds preferentially remove low angular momentum material, while preserving the
gas with high angular momentum.  Thus, superbubble feedback is able to naturally
prevent both runaway star formation and the formation of a bulge through these
winds.

While a single galaxy can be a useful case study, multiple objects must be
studied in order to look at population-scale effects.  Chapter 4 extends the
results of chapter 3 by simulating an additional 17 objects, and uses these
simulations to examine if SN regulation can operate effectively in galaxies both
heavier and lighter than the Milky Way.  With this new sample (the McMaster
Unbiased Galaxy Simulations 2), we were able to demonstrate a critical mass at
which SN regulation of gas accretion and star formation breaks down.  Simulated
Galaxies that exceed this mass, $(\sim 10^{12}\Msun)$, overproduce stars,  most
of which form in a dense stellar bulge.  All of this arises due to a fundamental
relation between the mass loading of superbubble driven winds and the mass of
the galaxy.  When the escape velocity of the disc exceeds the sound speed of
superbubble-heated gas (which has a characteristic temperature of
$\sim3\times10^6$ K), only outflows which have entrained less material are able
to escape the galaxy. This leads to less gas ejection, and a shutdown of
regulation.  The fact that this shutdown occurs exactly at the galaxy mass where
powerful AGN are observed, and that it results in a vigorous transport of gas to
the nucleus of the galaxy make this result strong evidence that this shutdown
is a key component in the ``hand-off'' between SN and AGN feedback.

The MUGS2 simulations produced in chapter 4 contains a wealth of data useful for
future studies. Chapter 5 applied the MUGS2 galaxies produced in
\citet{Keller2016a} to examine the radial acceleration relation (RAR) derived by
\citet{McGaugh2016} from observations in the SPARC \citep{Lelli2016b} catalog.
We found that the tight relation seen in the SPARC data does not require new
fundamental physics (such as self-interacting dark matter, modified gravity, or
MOND).  Instead, the simple combination of dissipational collapse, together with
angular momentum conservation produces the RAR. This means that even galaxies
where SN fails to regulate their star formation (or even where SN are omitted
altogether) fall on the same observed relation.  This was the first published
demonstration of this in simulations, using untuned simulations made prior to
the publication of \citet{McGaugh2016}.

This thesis has shown that, with correct modelling, SN feedback can regulate the
growth of galaxies up to the mass of the Milky Way, but no further.  In galaxies
below this mass, SN efficiently drive galactic winds, primarily at
high redshift, that act to limit the availability of low angular momentum gas,
slowing the formation of stars and the stellar bulge. Without the
feedback from SMBHs, galaxies more massive than ours form far too many stars,
and primarily form those stars in a concentrated central bulge.  This transition
from SN to AGN feedback occurs due to a rapid drop in the effectiveness of
SN-driven outflows.  Finally, we showed that independent of the detailed
internal processes of galaxy evolution, the acceleration relation observed by
\citet{McGaugh2016} is simply a natural consequence of galaxy formation.

\section{The Impact and Context of these Results}
Developing a versatile, accurate, resolution insensitive model for SN feedback
has been a challenge in galaxy simulations for decades \citep{Katz1992}.  While
a number of recent models have been developed that are able to produce galaxies
which match some observables, all of these models have relied on purely
numerical features to enhance the effectiveness of feedback and counter the
losses due to limited resolution.  The \citet{Keller2014} model presented in
Chapter 2 is the first model of its kind that uses a first-principles approach
to prevent overcooling.  Beyond merely providing ``sufficient'' feedback, the
superbubble model also incorporates physics that previously have been omitted.
Thermal evaporation is a key process for mixing cold ISM with hot feedback
ejecta.  Prior to \citet{Keller2014}, this process was completely ignored, and
the local mass loading of feedback was set purely as a numerical parameter.
\citet{Rosdahl2016} illustrated this clearly, in a recent comparison project.
This paper implemented 5 popular feedback algorithms in the {\sc RAMSES} code:
simple thermal dumps; a delayed cooling model similar to \citet{Agertz2013}; a
kinetic model similar to \citet{DallaVecchia2008}; a stochastic thermal model
based on \citet{DallaVecchia2012}; and a hybrid model from \citet{Kimm2015}.
This allowed for a controlled test with isolated dwarf and Milky Way analog
galaxies. Each of these models, with ``fiducial'' parameter choices, produced
star formation rates that varied by nearly an order of magnitude in the
\citet{Kennicutt1998} star formation relation.  On top of that, the galaxies
showed marked morphological differences and 4 decades of variation in the
average wind mass loadings.  As we showed in \citet{Keller2015}, these winds are
critical to the formation of galaxies like the Milky Way.  In addition to the
inter-model variation, \citet{Rosdahl2016} also found that the numerical free
parameters for each model had a large impact on the resulting galaxy's star
formation rate, morphology, and outflow properties.  By building a more
conservative, physically motivated model where the local mass loading of
supernovae feedback is set by thermal evaporation, rather than numerically, we
sidestep many of these issues.

With previous models for stellar feedback, both the qualitative behaviour as
well as the precise, quantitative effects have been heavily determined by
poorly constrained numerical parameters.  This has made interpreting the results
of simulations difficult, as it is unclear what effects are a result of
the underlying physics and which are simply a result of the choice of parameters
used for the simulation.  Physics-driven, parameter-free models remove this
ambiguity, and allow us to produce results with greater confidence.  

The issue of local mass loading has been explored before in simulation.
\citet{Thacker2000} presented a survey of methods for depositing feedback
energy.  This work showed that choosing to deposit feedback energy into single
resolution elements vs. smoothing it over multiple elements had a significant
impact on whether that feedback energy could couple to the ISM without radiating
away.  \citet{Thacker2000} advocated the use of a brief adiabatic period,
similar to the delayed cooling model used in \citet{Stinson2006} and
\citet{Rosdahl2016} to prevent overcooling when feedback energy was smoothed.  A
more recent study by \citet{DallaVecchia2012} directly examined the question of
local mass loading with a model that used the temperature of post-feedback
gas as a single tunable parameter.  This is effectively the same as choosing
the amount of mass that each supernovae heats (the local mass loading).
They found that lower mass loadings result in hotter post-feedback gas, with
longer cooling times, and subsequently much more effective supernovae feedback.
The \citet{Keller2014} superbubble model is the first model to actually
incorporate a physical mechanism for determining this mass loading.  Previous
feedback models have been designed primarily to avoid the overcooling that can
occur when this mass loading is too high: superbubble feedback instead attempts
to calculate the {\it correct} local mass loadings, and allows the
feedback-heated gas to cool with realistic temperatures and densities.  

As we showed in \citet{Keller2015}, including thermal evaporation in simulations
of a Milky Way-like galaxy will drastically change the effectiveness of
SN-driven galactic winds.  Starving the galaxy of gas (either through ejection
of accreted gas, or prevention of accretion) is the only effective mechanism for
regulating star formation on cosmic timescales \citet{Keres2009}.  To prevent
the formation of bulges larger than the ones seen in the local universe, bulge
forming gas (low-angular momentum gas) must be removed from the ISM; because
SN-driven winds are most effective at high redshift, when this material is
mostly accreted, the outflows driven from the galaxy preferentially remove
bulge-forming gas.  A similar result was seen in simulations of dwarf galaxies
\citep{Governato2010, Brook2011}, but \citet{Keller2015} is the first work to
show that bulgeless disc galaxies similar to the Milky Way can be
produced through the same mechanism, and connect this with the regulation of
star formation.  An important conclusion of this study is that much of the past
work \citep{Stinson2013,Agertz2013,Hopkins2014} showing that SN feedback was
unable regulate star formation without the addition of ``early feedback'' from
radiation pressure, stellar winds, or photoionization was likely underestimating
the effectiveness of SN.  Since many of these studies used simpler, more
numerically-sensitive feedback models that also omitted thermal evaporation,
they were unable to effectively drive sufficient mass into hot, high entropy gas
that could leave the galaxy.  This study tells us that the disc-dominant
morphology and low stellar fraction in galaxies like our own all arise from the
same mechanism:  heavily mass loaded, high redshift winds.

Subgrid models are essential for including feedback from other sources as well.
Non-supernovae mechanisms for launching outflows and regulating star formation
are now being studied with numerical simulations.  Radiation pressure has been
examined in a number of studies \citep{Hopkins2014,Roskar2014,Agertz2015} using
fairly simple treatments, without full radiative transport.  These simulations
have included various models for feedback from SN and stellar winds, and have
not yet converged on a consensus regarding the effects of radiation.  However,
both \citet{Roskar2014} and \citet{Agertz2015} found that the optical depths
required for radiation pressure to drive effective outflows produce unrealistic
galaxy morphologies.  The effects of cosmic rays are beginning to be examined in
simulations with \citep{Girichidis2015} and without
\citep{Jubelgas2008,Booth2013} treatments for magnetohydrodynamics.  Most
simulations have found that cosmic rays are unable to drive sufficiently
mass-loaded outflows from Milky Way-like galaxies, but may be important both for
dwarf galaxies and the launching the cold, dusty phases of outflows in larger
galaxies.  With a better constrained SN model, these mechanisms can now be
re-examined with greater control, allowing SN and other effects to be
disentangled.

It has been suggested by numerous studies \citep{Benson2003,Bower2006} that AGN
feedback is critical to shaping the galaxy luminosity function.  Most
observations \citep{Kauffmann2003b} show that strong AGN are hosted in galaxies
with halo masses slightly greater than $\sim10^{12}\;M_\odot$.  By simulating a
collection of galaxies that bracket this mass, but omitting the effects of AGN
feedback, we were able to show that SN alone break down as a mechanism of
regulating star formation in these massive galaxies.  Importantly, this also
results in large angular momentum losses for gas within the disc, funneling
material to the central regions where SMBHs reside.  This, combined with the
failure of SN-driven galactic winds, suggests that SN are actually the mechanism
that determines where powerful AGN occur, a mechanism that has begun to be studied in
\citet{Bower2016}.

Chapter 5 presented the first simulation result to reproduce the
\citet{McGaugh2016} RAR.  A later study \citep{Ludlow2016} used data from the
EAGLE \citep{Schaye2015} and APOSTLE \citep{Sawala2016} simulations and
confirmed both the fit to the RAR, and the insensitivity to feedback that we
found.  Earlier, a semi-empirical model was used by \citet{DiCintio2016} showed
that a related observation, the mass-discrepancy acceleration relation, could be
produced simply as a result of other pre-existing scaling relations.  Taken
together, these results should seriously temper attempts to fit/explain the RAR
using new, exotic physics.  If conventional baryonic physics produces the same
relation in a $\Lambda CDM$ cosmology, there is little need to turn to modified
gravity \citep{Moffat2016,Verlinde2016,Burrage2016} to explain it.  Tests of
cosmology have been moving closer to scales where the effects of baryonic
physics are becoming more pronounced.  Without well-constrained subgrid models,
like the one presented here, we will be unable to use the wealth of information
available from galaxies to test new theories of gravity or alternative
cosmologies, or constrain the effects of known physics: AGN, cosmic rays,
MHD effects, etc.  On individual galaxy scales, $\Lambda CDM$ predictions {\it must}
include the details of baryonic effects.  Chief among those effects is feedback.

\section{Future Directions}
The results presented in this thesis have greatly clarified the effects of SN
feedback, but also raised some questions.  While we now know how SN regulate the
growth of stars in galaxies up to the mass of the Milky Way, details about the
transition to AGN regulation at high mass are still unclear.  The outflows that
shape the galaxy, as we showed in chapter 3 and 4, are detailed, multiphase
flows.  How exactly mass is entrained within these outflows and how that
material is recycled back into the disc will require further study as well.
Finally, the small sample of 18 galaxies we studied in chapter 4 and 5 are a
tiny fraction of the range of mass, morphology and environment in real
galaxies.  How does superbubble feedback work to shape the scaling relations
seen in galaxies both more and less massive than the ones we have seen here?
The results of chapter 4 suggest that feedback from AGN is a critical process
for more massive galaxies.

While observational evidence abounds for the existence of SMBHs
\citep{Kormendy2013}, and the impact of the AGNs they power
\citep{Veilleux2005}, there is still great uncertainty as to the details of how
they regulate their own growth, and the growth of the galaxies they live in.
\citet{Keller2016a} showed evidence that a transition must occur between
galaxies regulated by SN feedback to AGN feedback as they grow heavier than the
Milky Way.  How this handoff occurs remains widely unexplored.  Using the
superbubble feedback, along with new models for SMBH growth \citep{Hopkins2010}
and migration \citep{Tremmel2015}, we will be able to simulate the growth of
SMBHs in galaxies with greater confidence, using physically motivated feedback
and accretion models.  This will allow us to study the full gamut of galaxies
that exist, and study how the tight scaling relations between stellar bulges and
SMBHs might arise.

One of the biggest questions raised in chapter 4 was the origin of the scaling
relation between outflow mass loadings and disc mass.  Observations of galactic
winds tell us that they are multiphase \citep{Stark1984,Wakker1997}, containing
ionized, neutral, and molecular gas.  This structure is unresolved in our
simulations, and may ultimately be important to the cooling rates and recycling
times for these outflows.  Complete, detailed observations of outflowing
material in the CGM are difficult. This gas tends to be too cool and diffuse to
be a strong emitter of X-rays, and absorption line studies require the lucky
coincidence of a background quasar \citep{Weiner2009}.  The presence of cold
clouds in particular is a significant problem for theories of galactic wind
launching.  Analytic calculations and high resolution simulations suggest that
these clouds should be disrupted and mixed on timescales far shorter than is
required to ballistically launch them into the CGM.  In light of this, why do we
see these clouds?  They may be formed in-situ, or may be launched by the
fragmentation of superbubble shells, already accelerated to high velocities
during the momentum-conserving snowplow phase of the bubble's growth
\citet{Lagos2013}.  These processes all take place on length scales far below
what is resolvable in the cosmological simulations we have presented here.  High
resolution simulations of superbubble breakout from the ISM will be able to tell
us if this is indeed the origin of these clouds.  Understanding the details of
the multiphase CGM is key to understanding how galaxies accrete and expel gas,
as thermal instability in the CGM (which depends heavily on its density,
temperature, and metallicity) may be the mechanism by which spiral galaxies
today acquire the gas required to form new stars \citep{Marasco2012}.  

A related question to the detailed, large-scale breakout of galactic winds from
the ISM is the detailed, small scale breakout of supernovae from their natal
environments.  Studies have already been published examining the destruction of
molecular clouds by stellar winds and ionizing radiation
\citep{Murray2010,Walch2012}.  Only a handful have focussed on how SN-heated gas
can escape from molecular clouds \citep{Rogers2013}, and these have looked at
very controlled, simple initial clouds.  The transition between individual
supernovae in a molecular cloud and the growth of a new superbubble is likely
important to determining the maximum efficiency of SN, and how much 
of the $10^{51}\;\rm{erg}$ released per SN is lost before a superbubble can begin
to form.  This, like the evolution of cold clumps in galactic winds, will
require high-resolution simulations of star formation within realistic molecular
clouds.  Studies have begun \citep{Dobbs2015} to study molecular clouds selected
from global disc simulations and re-simulated at higher resolution.  Combining
these kinds of simulations with models for small-scale star formation, feedback
from stellar winds and massive stars, as well as thermal conduction and
evaporation will allow us to determine the true budget of energy available from
stellar feedback.

While the MUGS2 sample has been simulated with a robust, physically motivated
model for SN feedback, its sample size is small (only 18 galaxies), and covers a
limited range of halo masses ($\sim 4\times10^{11}-2\times10^{12}\;M_\odot$).
Modern large volume simulations like Illustris \citep{Vogelsberger2014b} and
EAGLE \citep{Schaye2015} contain $>10^6$ individual galaxies, spanning a range
of masses that include both galaxies lighter and more massive than those we have
studied here.  These larger sample sizes are essential to understanding how
whole populations of galaxies evolved from the earliest linear structures.
While these simulations contain models for star formation, feedback from both
stars and AGN, as well as radiative cooling, these have all been fine-tuned to
fit observed scaling relations.  This limits the ability of these simulations to
explain the origins of the observations they have been tuned to fit.  The
superbubble model contains no free/tuned parameters, and accurately follows the
evolution of feedback-heated gas as it evaporates cool material that surrounds
it.  It is the only feedback model currently in existence that captures the
important physical process of thermal conduction and evaporation.  It will allow
us to build a statistically significant sample of physically realistic galaxies.
With first-principles, physically motivated models for the unresolved physics in
our simulations, we will be able to study the actual physics involved in shaping
both individual galaxies and the populations that we observe. 
\bibliographystyle{mnras}
\bibliography{library}
